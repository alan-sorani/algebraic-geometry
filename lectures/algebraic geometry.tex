\documentclass[10pt,a4paper,twoside,openany,hidelinks]{book}

%JAPANESE
\usepackage{fontspec}
\defaultfontfeatures{Ligatures={NoCommon, NoDiscretionary, NoHistoric, NoRequired, NoContextual}}
\setmainfont{CMU Serif}
\usepackage{xeCJK}
\xeCJKsetup{CJKmath=true}
\setCJKmainfont{MS Mincho} % or some other Japanese font

\usepackage{maths}
\usepackage{stylish}

\usepackage{tkz-graph}
\GraphInit[vstyle = Shade]

\title{Lecture Notes to Fundamental Concepts in Algebraic Geometry \\ \large{Spring 2020, Hebrew University of Jerusalem}}
\author{Ariel Schnidman\\ \large{Typed by Elad Tzorani}}
\date{\today}

\usepackage{lipsum}
\usepackage{stmaryrd}

\tikzset{EdgeStyle/.style   = {thick,
                               double          = orange,
                               double distance = 1pt}}

\tikzset{
    labl0/.style={anchor=south, rotate=-30, inner sep=.5mm}
}

\tikzset{
    labl1/.style={anchor=south, rotate=30, inner sep=.5mm}
}

\tikzset{
    labl2/.style={anchor=south, rotate=60, inner sep=.5mm}
}

\tikzset{
    labl3/.style={anchor=south, rotate=90, inner sep=.5mm}
}

\tikzset{
    labl4/.style={anchor=south, rotate=-90, inner sep=.5mm}
}

\usepackage{scalerel,stackengine}
\stackMath
\newcommand\widecheck[1]{%
\savestack{\tmpbox}{\stretchto{%
  \scaleto{%
    \scalerel*[\widthof{\ensuremath{#1}}]{\kern-.6pt\bigwedge\kern-.6pt}%
    {\rule[-\textheight/2]{1ex}{\textheight}}%WIDTH-LIMITED BIG WEDGE
  }{\textheight}% 
}{0.5ex}}%
\stackon[1pt]{#1}{\scalebox{-1}{\tmpbox}}%
}
\parskip 1ex

\newcommand{\from}{\leftarrow}

\usepackage[nottoc]{tocbibind}

\begin{document}
\frontmatter
\frontpage{front}{0.8\textwidth}{}
\tableofcontents
\countlectures
\newpage

\chapter*{Preface}
\addcontentsline{toc}{chapter}{Preface} \markboth{Preface}{}

\section*{Technicalities}
\addcontentsline{toc}{section}{Technicalities} %\markboth{Technicalities}{}

These aren't formal notes related to the course and henceforward there is \emph{absolutely no guarantee} that the recorded material is in correspondence with the course expectations, or that these notes lack any mistakes.\\
In fact, there probably are mistakes in the notes! I would highly appreciate if any comments or corrections were sent to me via email at \href{mailto:tzorani.elad@gmail.com}{tzorani.elad@gmail.com}.\\
Elad Tzorani.

\mainmatter

\chapter*{Goals of Algebraic Geometry}

The main goals of algebraic geometry are the following.

\begin{itemize}
\item To classify algebraic varieties up to birational isomorphism.
Either by enumeration of the varieties or classification by properties.
\item
Be able to tell whether two algebraic varieties are (birationally) isomorphic. This is done through different tools:
\begin{itemize}
\item Cohomology (related to the Hodge Conjecture).
\item Vector bundles (related to K-theory).
\item Algebraic Cycles (subvarieties).
\item Coherent sheaves (derived category).
\item Topology.
\end{itemize}
\end{itemize}

\chapter{Sheaves}

Let $X \in \Top$.

\begin{definition}
Let $\Top_X$ be the category of open sets on $X$ with inclusions as morphisms.
\end{definition}

\begin{notation}
Denote by $\Ab$ the category of abelian groups.
\end{notation}

\begin{definition}[Presheaf]
A \stress{presheaf (of groups)} on $X$ is a contravariant functor
\[F \colon \Top_X \to \Ab \text{.}\]
\end{definition}

Concretely, to give a presheaf we must give the following:
\begin{enumerate}
\item For each $U \subseteq X$ open, an abelian group $F\prs{U}$.
\item For inclusion $V \rmono U$ of open sets, a group homomorphism $F_{U,V} \colon F\prs{U} \to F\prs{V}$.
\end{enumerate}
Under the conditions:
\begin{enumerate}
\item $F_{U,U} = \id_{F\prs{U}}$.
\item If $W \rmono V \rmono U$ then $W \rmono U$ so the induced maps
\[
\begin{tikzcd}
F\prs{U} \arrow[r] \arrow[rr, bend right = 30] & F\prs{V} \arrow[r] & F\prs{W}
\end{tikzcd}
\]
commute.
\end{enumerate}

\begin{examples}
\begin{enumerate}
\item Let \[F\prs{U} \ceq \hom\prs{U, \RR} = \set{f \colon U \to \RR} \text{.}\]
If $V \subseteq U$ are open,
\begin{align*}
F\prs{U} &\xrightarrow{F_{U,V}} F\prs{V} \\
f &\mapsto \rest{f}{V} \hphantom{F\prs{V}} \text{.}
\end{align*}

This is actually also a presheaf of rings on $X$.

\item \stress{The constant presheaf:} Let $A \in \Ab$ and define
\[F\prs{U} \ceq A, \quad F_{U,V} = \id_A \text{.}\]

\item Let $k$ be an algebraically closed field and $X$ an algebraic variety over $k$. We can think $X \subseteq \PP_k^n$.

Define $\Oo_X\prs{U} \ceq \set{f \colon U \to k}{\text{$f$ is regular}}$.
By ``regular'' we mean that for all $P \in U$ there's a neighbourhood $V \subseteq U$ of $P$ such that
\[\rest{f}{V} = \frac{g}{h}\]
with
$g,h \in k\brs{x_0, \ldots, x_n}$.

\item Let $X = \PP^1$.
Then
$\Oo_{\PP^1}\prs{\PP^1} = k$.
Also
$\Oo_{\PP^1} \prs{\PP^1 \setminus \set{0}} = \set{\frac{g\prs{x,y}}{h\prs{x,y}}}{\substack{g,h \in k\brs{x,y}\\\forall \prs{x,y} \neq \prs{0,1} \colon h\prs{x,y} \neq 0}} = \set{\frac{g\prs{x,y}}{x^{\deg\prs{g}}}}$.
\end{enumerate}
\end{examples}

\begin{definition}[Section, Restriction]
For any $F$ as above, $s \in F\prs{U}$ is called a \stress{section}.
$F_{U,V}\prs{s}$ is written as $\rest{s}{V}$ and called \stress{restriction of $s$ to $V$}.
\end{definition}

\begin{definition}[Global Section]
$F\prs{X} \ceq \Gamma\prs{X,F}$ is the \stress{global section of $F$}.
\end{definition}

\begin{remark}
Why ``section''? Think about $\Oo_X\prs{U}$ and view the diagram
\[
\begin{tikzcd}
U \times k \arrow[d,"\pi_U"] \arrow[r, hook] & X \times k \arrow[d,"\pi"] \\
U \arrow[u, "\tilde{s}", bend left = 40] \arrow[r, hook] & X
\end{tikzcd}
\]
and call $X \times k$ the \stress{trivial line bundle}.

Take $s \in \Oo_X\prs{U}$ which induces a map
\begin{align*}
\tilde{s} \colon U &\to U \times k \\
x &\mapsto \prs{X, s\prs{x}} \text{.}
\end{align*}
Then $\tilde{s}$ is a {section of $\pi$ over $U$}
in the sense that $\pi_U \circ \tilde{s} = \id_U$.
\end{remark}

The idea of sheaves is that global sections are difficult to study topologically, but $F\prs{U}$ is easier to study for $U$ small, and computation on smaller $U$ can imply properties of $F\prs{U}$.

\begin{definition}[Sheaf]
A \stress{sheaf (over an abelian group)} $F$ is a presheaf over an abelian group such that the following holds.
\begin{enumerate}
\item If $U \subseteq X$ is open and $\set{V_i}_{i \in I}$ is an open cover of $U$, and if $s \in F\prs{U}$ such that $\forall i \in I \colon \rest{s}{V_i} = 0$ then $s = 0$.
\item If $U \subseteq X$ is open and $\set{V_i}_{i \in I}$ is an open cover, and if \[\forall i \in I \exists s_i \in F\prs{V_i} \forall i,j \in I \colon \rest{s_i}{V_i \cap V_j} = \rest{s_j}{V_i \cap V_j}\]
then
\[\exists ! s \in F\prs{U} \forall i \in I \colon \rest{s}{V_i} = s_i \text{.}\]
\end{enumerate}
\end{definition}

\begin{remark}
\begin{enumerate}
\item
We could equivalently remove the uniqueness requirement in the second condition as it's implied by the first condition.
\item
With the uniqueness condition, the first condition is implied by the second.
\end{enumerate}
\end{remark}

\begin{remark}
There is a categorical definition of a sheaf over any (not necessarily abelian) category, which might be defined later in these notes.
\end{remark}

\begin{examples}
\begin{enumerate}
\item $\Oo_x$ is a sheaf on $X$.
\item $F\prs{U} = A \in \Ab$ is \stress{not} in general a sheaf unless $A = 0$.

If $X$ has two connected components one can choose different elements of $A$ on two disjoint open sets, which agree on the (empty) intersection, but which we can't lift to the union.
\item Give $A \in \Ab$ the discrete topology.
Define $F_A\prs{U} \ceq \hom_{\mrm{cont}}\prs{U,A}$ the set of continuous functions $U \to A$.
This is a sheaf.

This is sometimes called the \stress{constant sheaf}, although it isn't actually constant.
If $U \subseteq A$ is connected then $F_A\prs{U} \cong A$.
\end{enumerate}
\end{examples}

\begin{definition}[Stalk of a Sheaf]
Let $p \in X$ and $F$ a presheaf on $X$.
The \stress{stalk of $F$ at $p$} is
\[F_p \ceq \lim_{\substack{\longrightarrow \\ p \in U \subseteq X}} F\prs{U} = \quot{\coprod_{p \in U \subseteq X} F\prs{U}}{\substack{\prs{U, s \in F\prs{U}} \sim \prs{V, t \in F\prs{V}} \\ \text{if $\rest{s}{U \cap V} = \rest{t}{U \cap V}$} \hphantom{lala}\text{.}}} \]
\end{definition}

\begin{definition}[Morphism of Presheaves]
Let $F,G$ be presheaves on $X$, a morphism $f \colon F \to G$ is a natural transformation.
\end{definition}

\begin{remark}
Concretely, a morphism $f \colon F \to G$ of presheaves is a group homomorphism
\[f_u \colon F\prs{U} \to G\prs{U}\]
for every $U \subseteq X$ open such that the diagram
\[
\begin{tikzcd}
F\prs{U} \arrow[r, "f_U"] \arrow[d, "\mrm{res}", swap] & G\prs{U}\arrow[d, "\mrm{res}"] \\
F\prs{V} \arrow[r, "f_V", swap] & G\prs{V}
\end{tikzcd}
\]
\end{remark}

\begin{definition}[Isomorphism of Presheaves]
A morphism of presheaves is an isomorphism if it has a two-sided inverse.
\end{definition}

\begin{notation}
If $\phi \colon F \to G$ is a morphism there's a an induced map on stalks
\begin{align*}
\phi_p \colon F_p \to G_p
\end{align*}
for every $p \in X$ where we remind
\begin{align*}
F_p &= \lim_{\substack{\longrightarrow \\ p \in U}} F\prs{U} \\
G_p &= \lim_{\substack{\longrightarrow \\ p \in U}} G\prs{U} \text{.}
\end{align*}
\end{notation}

\begin{definition}[Morphism of Sheaves]
A morphism of sheaves is a morphism between the respective presheaves. 
\end{definition}

\begin{remark}
The above implies that presheaves over $X$ are a full subcategory of sheaves over $X$.
\end{remark}

\begin{proposition}
Let $\phi \colon F \to G$ be a morphism of sheaves.
Then $\phi$ is an isomorphism iff $\phi_p$ is an isomorphism for every $p \in X$.
\end{proposition}

\begin{remark}
The above does \stress{not} say that $F \cong G$ iff $F_p \cong G_p$ for every $p \in X$.

This isn't true.
\end{remark}

\begin{proof}
\begin{description}
\item[$\Rightarrow$:] This is straightforward.
\item[$\Leftarrow$:]
\begin{description}
\item[Injectivity:]
Let $U \subseteq X$ open and $s \in F\prs{U}$ such that $\phi\prs{s} = 0$. WTS (want to show) $s = 0$.

Observe the following commutative diagram.
\[
\begin{tikzcd}
F\prs{U} \arrow[r, "\phi"] \arrow[d] & G\prs{U} \arrow[d] \\
F_p \arrow[r, swap, "\phi_p"] & G_p
\end{tikzcd}
\]
$\phi_p\prs{s_p} = 0$ implies by injectivity $s_p = 0$. Then
\[\exists p \in W_p \subseteq U \colon \rest{s}{W_p} = 0 \text{.}\]
We can cover $U$ by these $\set{W_p}_{o \in U}$ is a cover over $U$ and by the first sheaf condition we get $s = 0$.
\item[Surjectivity:]
%26.3.2020
We want to show that $\phi_U \colon F\prs{U} \to G\prs{U}$ is surjective for every $U \subseteq X$ open.

Let $s \in G\prs{U}$, we consider the following commutative diagram for every $p \in X$.
\[
\begin{tikzcd}
F\prs{U} \arrow[r,"\phi"] \arrow[d] & G\prs{U} \arrow[d] \\
F_p \arrow[r, "\phi_p"] & G_p
\end{tikzcd}
\]
Take $s \in G\prs{U}$ from which we get $s_p \in G_p$.
Then by surjectivity of $\phi_p$ there's $\tilde{t}_p \in F_p$ such that $\phi_p\prs{\tilde{t}_p} = s_p$.
Then there's $p \in W_p \subseteq U$ and $t_p \in F\prs{W_p}$ such that
$\phi_{W_p}\prs{t_p} = \rest{s}{W_p}$.
We want to glue the $t_p$ to get $t \in F\prs{U}$.

Check that the overlaps agree by showing that for $P,Q \in U$, $t_P, t_Q$ agree.
Indeed,
\begin{align*}
\phi\prs{\rest{t_P}{W_P \cap W_Q}} &= \rest{\phi\prs{t_P}}{W_P \cap W_Q}
\\&=
\rest{\prs{\rest{s}{W_P}}}{W_P \cap W_Q}
\\&= \brs{\text{same computation}}
\\&= \phi\prs{\rest{t_Q}{W_P \cap W_Q}}
\end{align*}
and by injectivity we get
\[\forall P,Q \in U \colon \rest{t_P}{W_P \cap W_Q} = \rest{t_Q}{W_P \cap W_Q} \text{.}\]

Since $F$ is a sheaf, there's $t \in F\prs{U}$ such that $\rest{t}{W_p} = t_p$.

We want to check that $\phi\prs{t} = s \in G\prs{U}$. Because $G$ is a sheaf we can check this locally.
\begin{align*}
\rest{\phi\prs{t}}{W_p} &= \phi\prs{\rest{t}{W_p}}
\\&=
\phi\prs{t_p}
\\&=
\rest{s}{W_p}
\end{align*}
Then by uniqueness of the restrictions $\phi\prs{t} = s$, so $\phi$ is indeed surjective.
\end{description}
\end{description}
\end{proof}

\begin{definition}
Let $\phi \colon F \to G$ a morphism of presheaves of abelian groups. Define the following presheaves.
\begin{align*}
\prs{\ker \phi}{U} &\ceq \ker\prs{\phi_U} \subseteq F\prs{U} \\
\prs{\widetilde{\coker}\phi}\prs{U} &\ceq \coker\prs{\phi_U} = \quot{G\prs{U}}{\phi\prs{F\prs{U}}} \\
\prs{\widetilde{\im}\phi}\prs{U} &= \im\prs{\phi_U} \subseteq G\prs{U}
\end{align*}
$\ker \phi$ is a sheaf if $F,G$ are. The other two aren't necessarily sheaves in this case.
\end{definition}

In order to define cokernel and image which are sheaves, we produce a functor from presheaves to sheaves, which is adjoint to the forgetful functor.

\begin{proposition}[Sheafification]
Let $F$ be a presheaf on $X$, there's a sheaf $F^+$ and a morphism $\theta \colon F \to F^+$ such that the following holds.

If $G$ is a sheaf and $F \to G$ is a morphism of presheaves, there's a unique morphism $\psi \colon F^+ \to G$ such that the following diagram commutes.
\[
\begin{tikzcd}
F \arrow[rr] \arrow[dr, "\theta", swap] & & G \\
& F^+ \arrow[ru, "\psi", swap, dotted] &
\end{tikzcd}
\]

Moreover, $\prs{F^+, \theta}$ is unique up to unique isomorphism. I.e if $F \xrightarrow{\theta'} F'^+$ is another such object, there's a unique isomorphism such that the following commutes.
\[
\begin{tikzcd}
F \arrow[r, "\theta'"] \arrow[dr, "\theta"] & \prs{F'}^+ \arrow[d, "\sim" labl4, dotted] \\
& F^+
\end{tikzcd}
\]
\end{proposition}

\begin{proof}
Define $F^+$ as follows. For $U \subseteq X$ open let
\[F^+\prs{U} = \set{s \colon U \to \prod_{p \in U} F_p}{\substack{\forall p \in U \colon s\prs{p} \in F_p \\ \forall p \in U \exists p \in V \subseteq U \exists t \in F\prs{U} \forall Q \in V \colon t_Q = s\prs{Q} \in F_Q}} \text{.}\]
Check that this is a sheaf.

Define
\begin{align*}
\theta \colon F &\to F^+ \\
F\prs{U} &\to F^+\prs{U} \\
s \in F\prs{U} &\mapsto \brs{\substack{U \to \coprod F_p \\
p \mapsto s_p}} \text{.}
\end{align*}
Check that $\prs{F^+, \theta}$ satisfies the universal property.
\end{proof}

We have the following properties.

\begin{proposition}
\begin{enumerate}
\item If $F$ is a sheaf, $\theta \colon F \to F^+$ is an isomorphism.

This follows from the universal property.
\item If $p \in X$ then $F_p \cong \prs{F^+}_p$ via $\theta$.
\end{enumerate}
\end{proposition}

\begin{definition}[Subsheaf]
Let $F$ a sheaf, a \stress{subsheaf} $F'$ is a sheaf such that the diagram
\[
\begin{tikzcd}
F'\prs{U} \arrow[r, hook] \arrow[d] & F\prs{U} \arrow[d] \\
F'\prs{V} \arrow[r,hook] & F\prs{V}
\end{tikzcd}
\]
commutes for all $V \subseteq U$.
\end{definition}

\begin{definition}[$\coker, \im$]
Let $\phi \colon F \to G$ a morphism of sheaves then $\ker \phi$ is already a sheaf.

Define
\begin{align*}
\im \phi &\ceq \prs{\widetilde{\im} \phi}^+ \\
\coker\phi &\ceq \prs{\widetilde{\coker} \phi}^+ \text{.}
\end{align*}
\end{definition}

\begin{remark}
By the universal property $\im \phi \rmono G$ is an injection.
\end{remark}

\begin{definition}[Injective Morphism]
We say $\phi$ is \stress{injective} if $\ker \phi = 0$, i.e. if $\phi_U$ is injective for every $U$.
\end{definition}

\begin{definition}[Surjective Morphism]
We say $\phi$ is \stress{surjective} if $\im \phi = G$.
\end{definition}

\begin{remark}
Surjectivity is \stress{not} equivalent to $\phi_U$ being surjective for all $U$.
\end{remark}

\begin{definition}[Exact Sequence]
Say a sequence of sheaves
\[\cdots \rightarrow F_{-2} \xrightarrow{\phi_{-2}} F_{-1} \xrightarrow{\phi_{-1}} F_0 \xrightarrow{\phi_0} F_1 \xrightarrow{\phi_1} \cdots\]
is \stress{exact} if $\ker \phi_i = \im \phi_{i-1}$.

If $F' \subseteq F$, define $\quot{F'}{F}$ to be the sheafification of the presheaf
\[U \mapsto \quot{F'\prs{U}}{F\prs{U}} \text{.}\]
\end{definition}

\begin{definition}[Pushward and Inverse Image Sheaves]
Let $f \colon X \to Y$ be a continuous map of topological spaces.

Let $F$ be a sheaf on $X$, we define for $V \subseteq Y$ open
\[\prs{f_* F}\prs{V} \ceq F\prs{f^{-1}\prs{V}} \text{.}\]
Then $f_* F$ is a sheaf on $Y$
and is called the \stress{pushforward of $F$}.

If $f \colon X \to Y$ and $G$ a sheaf on $Y$. We define for $U \subseteq X$ open
\[\prs{f^{-1}G}\prs{U} = \prs{\lim_{\substack{\longrightarrow \\ V \supseteq f\prs{U}}} G\prs{V}}^+ \text{.}\]
Then $f^{-1}G$ is a sheaf and called the \stress{inverse image sheaf}.
\end{definition}

\begin{remark}
$f_*$ and $f^{-1}$ are functors between sheaves on $X$ and $Y$.
\end{remark}

\begin{exercise}
$f_*$ and $f^{-1}$ are adjoint functors.
I.e.
\[\hom_X\prs{f^{-1}G, F} \cong \hom_Y\prs{G, f_* F}\]
naturally.
\end{exercise}

\begin{notation}
Let $Z \subseteq X$ and $i \colon Z \rmono X$ the inclusion map. For a sheaf $F$ on $X$ we write $\rest{F}{Z}$ instead of $i^{-1} F$.
\end{notation}

\begin{exercise}
Assume $F\prs{A} = A \in \Ab$ and that $\theta U \subseteq X$.
Let
\[F_A\prs{U} \ceq \hom_{\mrm{cont}}\prs{U,A} \text{,}\]
we get
$F_A \cong F^+$.
\end{exercise}

\chapter{Schemes}

\section{Motivation} 

We notice that in in classical algebraic geometry the interesting object of an algebraic variety is its ring of functions $R$. It induces a map on the points which are $\mspec\prs{R}$.

There is however the problem that this lacks functoriality. Images and preimages of maximal ideals aren't necessarily maximal.
For this one looks at the space of prime ideals $\spec\prs{R}$. 
If we look at $R = \CC\brs{x}$ we get $\spec R = \AA^1 \cup \set{\prs{0}}$. We don't have a natural way to add $\prs{0}$ to the topology of $\AA^1$. In higher dimension this is even more problematic.
However, these points have important meaning which we want to understand through the notion of schemes.

\section{Schemes - Basic Definitions}

Let $A \in \Ring$, we define $\spec A$ as the space of prime ideals of $A$.

Given $\aa \ideal A$ we define
\[V\prs{\aa} = \set{\pp \in \spec\prs{A}}{\pp \supseteq \aa} \text{.}\] 
This is in bijection with $\spec\prs{\quot{A}{\aa}}$.

\begin{lemma}
\begin{enumerate}
\item Let $\aa_1, \aa_2 \ideal A$. Then
\[V\prs{\aa_1 \aa_2} = V\prs{\aa_1} \cup V\prs{\aa_2} \text{.}\]
\item If $\set{\aa_i}_{i \in I}$ are ideals of $A$ then
\[V\prs{\sum_{i \in I} \aa_i} = \bigcap_{i \in I} V\prs{\aa_i} \text{.}\]
\item If $\aa_1, \aa_2 \ideal A$ then
\[V\prs{\aa_1} \subseteq V\prs{\aa_2} \iff \sqrt{\aa_1} \supseteq \sqrt{\aa_2} \text{.}\]
\end{enumerate}
\end{lemma}

\begin{proof}
See Hartshorne.
\end{proof}

\begin{remark}
$V\prs{A} = \ns$ and $V\prs{\prs{0}} = \spec A$.
\end{remark}

\begin{definition}[Zariski Topology]
We give $\spec A$ the topology defined by the closed sets $V\prs{\aa}$ for $\aa \ideal A$.

This is called the \stress{Zariski topology}.
\end{definition}



\backmatter
\end{document}